<?xml version="1.0" encoding="utf-8" ?>
<otrs_package version="1.1">
    <Name>OTRSSqlQueriesHistory</Name>
    <Version>1.0.0</Version>
    <Vendor>bieli.net</Vendor>
    <URL>http://bieli.net/</URL>
    <License>This source code is published under GPL v3 licence</License>
    <Description Lang="en">This OTRS 3 package extends AdminSelectBox module for storing SQL queries history.</Description>
    <Description Lang="pl">Moduł ten rozszerza moduł AdminSelectBox o składowanie historii zapytań SQL.</Description>
    <Framework>3.0.x</Framework>
    <Framework>3.1.x</Framework>
    <BuildDate>2013-03-11 23:10:51</BuildDate>
    <BuildHost>yourhost.example.com</BuildHost>
    <Filelist>
        <File Location="Kernel/Config/Files/OTRSSqlQueriesHistory.xml" Permission="666" Encode="Base64">PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiID8+CjxvdHJzX2NvbmZpZyB2ZXJzaW9uPSIxLjAiIGluaXQ9IkFwcGxpY2F0aW9uIj4KICAgIDxDVlM+JElkOiBPVFJTU3FsUXVlcmllc0hpc3RvcnkueG1sLHYgMS4wLjAuMCAyMDEyLzA5LzIyIDIxOjEyOjIgYmllbGkgRXhwICQ8L0NWUz4KICAgIDxDb25maWdJdGVtIE5hbWU9IkZyb250ZW5kOjpNb2R1bGUjIyNBZG1pblNlbGVjdEJveCIgUmVxdWlyZWQ9IjAiIFZhbGlkPSIxIj4KICAgICAgICA8RGVzY3JpcHRpb24gVHJhbnNsYXRhYmxlPSIxIj5Gcm9udGVuZCBtb2R1bGUgcmVnaXN0cmF0aW9uIGZvciB0aGUgYWdlbnQgaW50ZXJmYWNlLjwvRGVzY3JpcHRpb24+CiAgICAgICAgPEdyb3VwPkZyYW1ld29yazwvR3JvdXA+CiAgICAgICAgPFN1Ykdyb3VwPkZyb250ZW5kOjpBZG1pbjo6TW9kdWxlUmVnaXN0cmF0aW9uPC9TdWJHcm91cD4KICAgICAgICA8U2V0dGluZz4KICAgICAgICAgICAgPEZyb250ZW5kTW9kdWxlUmVnPgogICAgICAgICAgICAgICAgPEdyb3VwPmFkbWluPC9Hcm91cD4KICAgICAgICAgICAgICAgIDxEZXNjcmlwdGlvbj5BZG1pbjwvRGVzY3JpcHRpb24+CiAgICAgICAgICAgICAgICA8VGl0bGU+U1FMIEJveDwvVGl0bGU+CiAgICAgICAgICAgICAgICA8TmF2QmFyTmFtZT5BZG1pbjwvTmF2QmFyTmFtZT4KICAgICAgICAgICAgICAgIDxOYXZCYXJNb2R1bGU+CiAgICAgICAgICAgICAgICAgICAgPE1vZHVsZT5LZXJuZWw6Ok91dHB1dDo6SFRNTDo6TmF2QmFyTW9kdWxlQWRtaW48L01vZHVsZT4KICAgICAgICAgICAgICAgICAgICA8TmFtZSBUcmFuc2xhdGFibGU9IjEiPlNRTCBCb3g8L05hbWU+CiAgICAgICAgICAgICAgICAgICAgPERlc2NyaXB0aW9uIFRyYW5zbGF0YWJsZT0iMSI+RXhlY3V0ZSBTUUwgc3RhdGVtZW50cy48L0Rlc2NyaXB0aW9uPgogICAgICAgICAgICAgICAgICAgIDxCbG9jaz5TeXN0ZW08L0Jsb2NrPgogICAgICAgICAgICAgICAgICAgIDxQcmlvPjcwMDwvUHJpbz4KICAgICAgICAgICAgICAgIDwvTmF2QmFyTW9kdWxlPgogICAgICAgICAgICAgICAgPExvYWRlcj4KICAgICAgICAgICAgICAgICAgICA8SmF2YVNjcmlwdD50aGlyZHBhcnR5L2pzdG9yYWdlL2pzdG9yYWdlLmpzPC9KYXZhU2NyaXB0PgogICAgICAgICAgICAgICAgICAgIDxKYXZhU2NyaXB0PkNvcmUuQWdlbnQuQWRtaW4uQWRtaW5TZWxlY3RCb3guanM8L0phdmFTY3JpcHQ+CiAgICAgICAgICAgICAgICA8L0xvYWRlcj4KICAgICAgICAgICAgPC9Gcm9udGVuZE1vZHVsZVJlZz4KICAgICAgICA8L1NldHRpbmc+CiAgICA8L0NvbmZpZ0l0ZW0+Cjwvb3Ryc19jb25maWc+Cgo=</File>
        <File Location="var/httpd/htdocs/js/thirdparty/jstorage/jstorage.js" Permission="666" Encode="Base64">LyoKICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gSlNUT1JBR0UgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKiBTaW1wbGUgbG9jYWwgc3RvcmFnZSB3cmFwcGVyIHRvIHNhdmUgZGF0YSBvbiB0aGUgYnJvd3NlciBzaWRlLCBzdXBwb3J0aW5nCiAqIGFsbCBtYWpvciBicm93c2VycyAtIElFNissIEZpcmVmb3gyKywgU2FmYXJpNCssIENocm9tZTQrIGFuZCBPcGVyYSAxMC41KwogKgogKiBDb3B5cmlnaHQgKGMpIDIwMTAgLSAyMDEyIEFuZHJpcyBSZWlubWFuLCBhbmRyaXMucmVpbm1hbkBnbWFpbC5jb20KICogUHJvamVjdCBob21lcGFnZTogd3d3LmpzdG9yYWdlLmluZm8KICoKICogTGljZW5zZWQgdW5kZXIgTUlULXN0eWxlIGxpY2Vuc2U6CiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwogKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwogKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgogKgogKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgogKiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKICogRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKICogTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUKICogU09GVFdBUkUuCiAqLwoKIChmdW5jdGlvbigpewogICAgdmFyCiAgICAgICAgLyogalN0b3JhZ2UgdmVyc2lvbiAqLwogICAgICAgIEpTVE9SQUdFX1ZFUlNJT04gPSAiMC4zLjAiLAoKICAgICAgICAvKiBkZXRlY3QgYSBkb2xsYXIgb2JqZWN0IG9yIGNyZWF0ZSBvbmUgaWYgbm90IGZvdW5kICovCiAgICAgICAgJCA9IHdpbmRvdy5qUXVlcnkgfHwgd2luZG93LiQgfHwgKHdpbmRvdy4kID0ge30pLAoKICAgICAgICAvKiBjaGVjayBmb3IgYSBKU09OIGhhbmRsaW5nIHN1cHBvcnQgKi8KICAgICAgICBKU09OID0gewogICAgICAgICAgICBwYXJzZToKICAgICAgICAgICAgICAgIHdpbmRvdy5KU09OICYmICh3aW5kb3cuSlNPTi5wYXJzZSB8fCB3aW5kb3cuSlNPTi5kZWNvZGUpIHx8CiAgICAgICAgICAgICAgICBTdHJpbmcucHJvdG90eXBlLmV2YWxKU09OICYmIGZ1bmN0aW9uKHN0cil7cmV0dXJuIFN0cmluZyhzdHIpLmV2YWxKU09OKCk7fSB8fAogICAgICAgICAgICAgICAgJC5wYXJzZUpTT04gfHwKICAgICAgICAgICAgICAgICQuZXZhbEpTT04sCiAgICAgICAgICAgIHN0cmluZ2lmeToKICAgICAgICAgICAgICAgIE9iamVjdC50b0pTT04gfHwKICAgICAgICAgICAgICAgIHdpbmRvdy5KU09OICYmICh3aW5kb3cuSlNPTi5zdHJpbmdpZnkgfHwgd2luZG93LkpTT04uZW5jb2RlKSB8fAogICAgICAgICAgICAgICAgJC50b0pTT04KICAgICAgICB9OwoKICAgIC8vIEJyZWFrIGlmIG5vIEpTT04gc3VwcG9ydCB3YXMgZm91bmQKICAgIGlmKCFKU09OLnBhcnNlIHx8ICFKU09OLnN0cmluZ2lmeSl7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJObyBKU09OIHN1cHBvcnQgZm91bmQsIGluY2x1ZGUgLy9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvanNvbjIvMjAxMTAyMjMvanNvbjIuanMgdG8gcGFnZSIpOwogICAgfQoKICAgIHZhcgogICAgICAgIC8qIFRoaXMgaXMgdGhlIG9iamVjdCwgdGhhdCBob2xkcyB0aGUgY2FjaGVkIHZhbHVlcyAqLwogICAgICAgIF9zdG9yYWdlID0ge30sCgogICAgICAgIC8qIEFjdHVhbCBicm93c2VyIHN0b3JhZ2UgKGxvY2FsU3RvcmFnZSBvciBnbG9iYWxTdG9yYWdlWydkb21haW4nXSkgKi8KICAgICAgICBfc3RvcmFnZV9zZXJ2aWNlID0ge2pTdG9yYWdlOiJ7fSJ9LAoKICAgICAgICAvKiBET00gZWxlbWVudCBmb3Igb2xkZXIgSUUgdmVyc2lvbnMsIGhvbGRzIHVzZXJEYXRhIGJlaGF2aW9yICovCiAgICAgICAgX3N0b3JhZ2VfZWxtID0gbnVsbCwKCiAgICAgICAgLyogSG93IG11Y2ggc3BhY2UgZG9lcyB0aGUgc3RvcmFnZSB0YWtlICovCiAgICAgICAgX3N0b3JhZ2Vfc2l6ZSA9IDAsCgogICAgICAgIC8qIHdoaWNoIGJhY2tlbmQgaXMgY3VycmVudGx5IHVzZWQgKi8KICAgICAgICBfYmFja2VuZCA9IGZhbHNlLAoKICAgICAgICAvKiBvbmNoYW5nZSBvYnNlcnZlcnMgKi8KICAgICAgICBfb2JzZXJ2ZXJzID0ge30sCgogICAgICAgIC8qIHRpbWVvdXQgdG8gd2FpdCBhZnRlciBvbmNoYW5nZSBldmVudCAqLwogICAgICAgIF9vYnNlcnZlcl90aW1lb3V0ID0gZmFsc2UsCgogICAgICAgIC8qIGxhc3QgdXBkYXRlIHRpbWUgKi8KICAgICAgICBfb2JzZXJ2ZXJfdXBkYXRlID0gMCwKCiAgICAgICAgLyogcHVic3ViIG9ic2VydmVycyAqLwogICAgICAgIF9wdWJzdWJfb2JzZXJ2ZXJzID0ge30sCgogICAgICAgIC8qIHNraXAgcHVibGlzaGVkIGl0ZW1zIG9sZGVyIHRoYW4gY3VycmVudCB0aW1lc3RhbXAgKi8KICAgICAgICBfcHVic3ViX2xhc3QgPSArbmV3IERhdGUoKSwgCgogICAgICAgIC8qIE5leHQgY2hlY2sgZm9yIFRUTCAqLwogICAgICAgIF90dGxfdGltZW91dCwKCiAgICAgICAgLyogY3JjMzIgdGFibGUgKi8KICAgICAgICBfY3JjMzJUYWJsZSA9ICIwMDAwMDAwMCA3NzA3MzA5NiBFRTBFNjEyQyA5OTA5NTFCQSAwNzZEQzQxOSA3MDZBRjQ4RiBFOTYzQTUzNSA5RTY0OTVBMyAiKwogICAgICAgICAgICAgIjBFREI4ODMyIDc5RENCOEE0IEUwRDVFOTFFIDk3RDJEOTg4IDA5QjY0QzJCIDdFQjE3Q0JEIEU3QjgyRDA3IDkwQkYxRDkxIDFEQjcxMDY0ICIrCiAgICAgICAgICAgICAiNkFCMDIwRjIgRjNCOTcxNDggODRCRTQxREUgMUFEQUQ0N0QgNkREREU0RUIgRjRENEI1NTEgODNEMzg1QzcgMTM2Qzk4NTYgNjQ2QkE4QzAgIisKICAgICAgICAgICAgICJGRDYyRjk3QSA4QTY1QzlFQyAxNDAxNUM0RiA2MzA2NkNEOSBGQTBGM0Q2MyA4RDA4MERGNSAzQjZFMjBDOCA0QzY5MTA1RSBENTYwNDFFNCAiKwogICAgICAgICAgICAgIkEyNjc3MTcyIDNDMDNFNEQxIDRCMDRENDQ3IEQyMEQ4NUZEIEE1MEFCNTZCIDM1QjVBOEZBIDQyQjI5ODZDIERCQkJDOUQ2IEFDQkNGOTQwICIrCiAgICAgICAgICAgICAiMzJEODZDRTMgNDVERjVDNzUgRENENjBEQ0YgQUJEMTNENTkgMjZEOTMwQUMgNTFERTAwM0EgQzhENzUxODAgQkZEMDYxMTYgMjFCNEY0QjUgIisKICAgICAgICAgICAgICI1NkIzQzQyMyBDRkJBOTU5OSBCOEJEQTUwRiAyODAyQjg5RSA1RjA1ODgwOCBDNjBDRDlCMiBCMTBCRTkyNCAyRjZGN0M4NyA1ODY4NEMxMSAiKwogICAgICAgICAgICAgIkMxNjExREFCIEI2NjYyRDNEIDc2REM0MTkwIDAxREI3MTA2IDk4RDIyMEJDIEVGRDUxMDJBIDcxQjE4NTg5IDA2QjZCNTFGIDlGQkZFNEE1ICIrCiAgICAgICAgICAgICAiRThCOEQ0MzMgNzgwN0M5QTIgMEYwMEY5MzQgOTYwOUE4OEUgRTEwRTk4MTggN0Y2QTBEQkIgMDg2RDNEMkQgOTE2NDZDOTcgRTY2MzVDMDEgIisKICAgICAgICAgICAgICI2QjZCNTFGNCAxQzZDNjE2MiA4NTY1MzBEOCBGMjYyMDA0RSA2QzA2OTVFRCAxQjAxQTU3QiA4MjA4RjRDMSBGNTBGQzQ1NyA2NUIwRDlDNiAiKwogICAgICAgICAgICAgIjEyQjdFOTUwIDhCQkVCOEVBIEZDQjk4ODdDIDYyREQxRERGIDE1REEyRDQ5IDhDRDM3Q0YzIEZCRDQ0QzY1IDREQjI2MTU4IDNBQjU1MUNFICIrCiAgICAgICAgICAgICAiQTNCQzAwNzQgRDRCQjMwRTIgNEFERkE1NDEgM0REODk1RDcgQTREMUM0NkQgRDNENkY0RkIgNDM2OUU5NkEgMzQ2RUQ5RkMgQUQ2Nzg4NDYgIisKICAgICAgICAgICAgICJEQTYwQjhEMCA0NDA0MkQ3MyAzMzAzMURFNSBBQTBBNEM1RiBERDBEN0NDOSA1MDA1NzEzQyAyNzAyNDFBQSBCRTBCMTAxMCBDOTBDMjA4NiAiKwogICAgICAgICAgICAgIjU3NjhCNTI1IDIwNkY4NUIzIEI5NjZENDA5IENFNjFFNDlGIDVFREVGOTBFIDI5RDlDOTk4IEIwRDA5ODIyIEM3RDdBOEI0IDU5QjMzRDE3ICIrCiAgICAgICAgICAgICAiMkVCNDBEODEgQjdCRDVDM0IgQzBCQTZDQUQgRURCODgzMjAgOUFCRkIzQjYgMDNCNkUyMEMgNzRCMUQyOUEgRUFENTQ3MzkgOUREMjc3QUYgIisKICAgICAgICAgICAgICIwNERCMjYxNSA3M0RDMTY4MyBFMzYzMEIxMiA5NDY0M0I4NCAwRDZENkEzRSA3QTZBNUFBOCBFNDBFQ0YwQiA5MzA5RkY5RCAwQTAwQUUyNyAiKwogICAgICAgICAgICAgIjdEMDc5RUIxIEYwMEY5MzQ0IDg3MDhBM0QyIDFFMDFGMjY4IDY5MDZDMkZFIEY3NjI1NzVEIDgwNjU2N0NCIDE5NkMzNjcxIDZFNkIwNkU3ICIrCiAgICAgICAgICAgICAiRkVENDFCNzYgODlEMzJCRTAgMTBEQTdBNUEgNjdERDRBQ0MgRjlCOURGNkYgOEVCRUVGRjkgMTdCN0JFNDMgNjBCMDhFRDUgRDZENkEzRTggIisKICAgICAgICAgICAgICJBMUQxOTM3RSAzOEQ4QzJDNCA0RkRGRjI1MiBEMUJCNjdGMSBBNkJDNTc2NyAzRkI1MDZERCA0OEIyMzY0QiBEODBEMkJEQSBBRjBBMUI0QyAiKwogICAgICAgICAgICAgIjM2MDM0QUY2IDQxMDQ3QTYwIERGNjBFRkMzIEE4NjdERjU1IDMxNkU4RUVGIDQ2NjlCRTc5IENCNjFCMzhDIEJDNjY4MzFBIDI1NkZEMkEwICIrCiAgICAgICAgICAgICAiNTI2OEUyMzYgQ0MwQzc3OTUgQkIwQjQ3MDMgMjIwMjE2QjkgNTUwNTI2MkYgQzVCQTNCQkUgQjJCRDBCMjggMkJCNDVBOTIgNUNCMzZBMDQgIisKICAgICAgICAgICAgICJDMkQ3RkZBNyBCNUQwQ0YzMSAyQ0Q5OUU4QiA1QkRFQUUxRCA5QjY0QzJCMCBFQzYzRjIyNiA3NTZBQTM5QyAwMjZEOTMwQSA5QzA5MDZBOSAiKwogICAgICAgICAgICAgIkVCMEUzNjNGIDcyMDc2Nzg1IDA1MDA1NzEzIDk1QkY0QTgyIEUyQjg3QTE0IDdCQjEyQkFFIDBDQjYxQjM4IDkyRDI4RTlCIEU1RDVCRTBEICIrCiAgICAgICAgICAgICAiN0NEQ0VGQjcgMEJEQkRGMjEgODZEM0QyRDQgRjFENEUyNDIgNjhEREIzRjggMUZEQTgzNkUgODFCRTE2Q0QgRjZCOTI2NUIgNkZCMDc3RTEgIisKICAgICAgICAgICAgICIxOEI3NDc3NyA4ODA4NUFFNiBGRjBGNkE3MCA2NjA2M0JDQSAxMTAxMEI1QyA4RjY1OUVGRiBGODYyQUU2OSA2MTZCRkZEMyAxNjZDQ0Y0NSAiKwogICAgICAgICAgICAgIkEwMEFFMjc4IEQ3MEREMkVFIDRFMDQ4MzU0IDM5MDNCM0MyIEE3NjcyNjYxIEQwNjAxNkY3IDQ5Njk0NzREIDNFNkU3N0RCIEFFRDE2QTRBICIrCiAgICAgICAgICAgICAiRDlENjVBREMgNDBERjBCNjYgMzdEODNCRjAgQTlCQ0FFNTMgREVCQjlFQzUgNDdCMkNGN0YgMzBCNUZGRTkgQkRCREYyMUMgQ0FCQUMyOEEgIisKICAgICAgICAgICAgICI1M0IzOTMzMCAyNEI0QTNBNiBCQUQwMzYwNSBDREQ3MDY5MyA1NERFNTcyOSAyM0Q5NjdCRiBCMzY2N0EyRSBDNDYxNEFCOCA1RDY4MUIwMiAiKwogICAgICAgICAgICAgIjJBNkYyQjk0IEI0MEJCRTM3IEMzMEM4RUExIDVBMDVERjFCIDJEMDJFRjhEIiwKCiAgICAgICAgLyoqCiAgICAgICAgICogWE1MIGVuY29kaW5nIGFuZCBkZWNvZGluZyBhcyBYTUwgbm9kZXMgY2FuJ3QgYmUgSlNPTidpemVkCiAgICAgICAgICogWE1MIG5vZGVzIGFyZSBlbmNvZGVkIGFuZCBkZWNvZGVkIGlmIHRoZSBub2RlIGlzIHRoZSB2YWx1ZSB0byBiZSBzYXZlZAogICAgICAgICAqIGJ1dCBub3QgaWYgaXQncyBhcyBhIHByb3BlcnR5IG9mIGFub3RoZXIgb2JqZWN0CiAgICAgICAgICogRWcuIC0KICAgICAgICAgKiAgICQualN0b3JhZ2Uuc2V0KCJrZXkiLCB4bWxOb2RlKTsgICAgICAgIC8vIElTIE9LCiAgICAgICAgICogICAkLmpTdG9yYWdlLnNldCgia2V5Iiwge3htbDogeG1sTm9kZX0pOyAvLyBOT1QgT0sKICAgICAgICAgKi8KICAgICAgICBfWE1MU2VydmljZSA9IHsKCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBWYWxpZGF0ZXMgYSBYTUwgbm9kZSB0byBiZSBYTUwKICAgICAgICAgICAgICogYmFzZWQgb24galF1ZXJ5LmlzWE1MIGZ1bmN0aW9uCiAgICAgICAgICAgICAqLwogICAgICAgICAgICBpc1hNTDogZnVuY3Rpb24oZWxtKXsKICAgICAgICAgICAgICAgIHZhciBkb2N1bWVudEVsZW1lbnQgPSAoZWxtID8gZWxtLm93bmVyRG9jdW1lbnQgfHwgZWxtIDogMCkuZG9jdW1lbnRFbGVtZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gIkhUTUwiIDogZmFsc2U7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogRW5jb2RlcyBhIFhNTCBub2RlIHRvIHN0cmluZwogICAgICAgICAgICAgKiBiYXNlZCBvbiBodHRwOi8vd3d3Lm1lcmN1cnl0aWRlLmNvLnVrL25ld3MvYXJ0aWNsZS9pc3N1ZXMtd2hlbi13b3JraW5nLWFqYXgvCiAgICAgICAgICAgICAqLwogICAgICAgICAgICBlbmNvZGU6IGZ1bmN0aW9uKHhtbE5vZGUpIHsKICAgICAgICAgICAgICAgIGlmKCF0aGlzLmlzWE1MKHhtbE5vZGUpKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0cnl7IC8vIE1vemlsbGEsIFdlYmtpdCwgT3BlcmEKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFhNTFNlcmlhbGl6ZXIoKS5zZXJpYWxpemVUb1N0cmluZyh4bWxOb2RlKTsKICAgICAgICAgICAgICAgIH1jYXRjaChFMSkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7ICAvLyBJRQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geG1sTm9kZS54bWw7CiAgICAgICAgICAgICAgICAgICAgfWNhdGNoKEUyKXt9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogRGVjb2RlcyBhIFhNTCBub2RlIGZyb20gc3RyaW5nCiAgICAgICAgICAgICAqIGxvb3NlbHkgYmFzZWQgb24gaHR0cDovL291dHdlc3RtZWRpYS5jb20vanF1ZXJ5LXBsdWdpbnMveG1sZG9tLwogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZGVjb2RlOiBmdW5jdGlvbih4bWxTdHJpbmcpewogICAgICAgICAgICAgICAgdmFyIGRvbV9wYXJzZXIgPSAoIkRPTVBhcnNlciIgaW4gd2luZG93ICYmIChuZXcgRE9NUGFyc2VyKCkpLnBhcnNlRnJvbVN0cmluZykgfHwKICAgICAgICAgICAgICAgICAgICAgICAgKHdpbmRvdy5BY3RpdmVYT2JqZWN0ICYmIGZ1bmN0aW9uKF94bWxTdHJpbmcpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgeG1sX2RvYyA9IG5ldyBBY3RpdmVYT2JqZWN0KCdNaWNyb3NvZnQuWE1MRE9NJyk7CiAgICAgICAgICAgICAgICAgICAgeG1sX2RvYy5hc3luYyA9ICdmYWxzZSc7CiAgICAgICAgICAgICAgICAgICAgeG1sX2RvYy5sb2FkWE1MKF94bWxTdHJpbmcpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB4bWxfZG9jOwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICByZXN1bHRYTUw7CiAgICAgICAgICAgICAgICBpZighZG9tX3BhcnNlcil7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmVzdWx0WE1MID0gZG9tX3BhcnNlci5jYWxsKCJET01QYXJzZXIiIGluIHdpbmRvdyAmJiAobmV3IERPTVBhcnNlcigpKSB8fCB3aW5kb3csIHhtbFN0cmluZywgJ3RleHQveG1sJyk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc1hNTChyZXN1bHRYTUwpP3Jlc3VsdFhNTDpmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIF9sb2NhbFN0b3JhZ2VQb2x5ZmlsbFNldEtleSA9IGZ1bmN0aW9uKCl7fTsKCgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gUFJJVkFURSBNRVRIT0RTIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoKICAgIC8qKgogICAgICogSW5pdGlhbGl6YXRpb24gZnVuY3Rpb24uIERldGVjdHMgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgRE9NIFN0b3JhZ2UKICAgICAqIG9yIHVzZXJEYXRhIGJlaGF2aW9yIGFuZCBiZWhhdmVzIGFjY29yZGluZ2x5LgogICAgICovCiAgICBmdW5jdGlvbiBfaW5pdCgpewogICAgICAgIC8qIENoZWNrIGlmIGJyb3dzZXIgc3VwcG9ydHMgbG9jYWxTdG9yYWdlICovCiAgICAgICAgdmFyIGxvY2FsU3RvcmFnZVJlYWxseVdvcmtzID0gZmFsc2U7CiAgICAgICAgaWYoImxvY2FsU3RvcmFnZSIgaW4gd2luZG93KXsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnX3RtcHRlc3QnLCAndG1wdmFsJyk7CiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2VSZWFsbHlXb3JrcyA9IHRydWU7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ190bXB0ZXN0Jyk7CiAgICAgICAgICAgIH0gY2F0Y2goQm9ndXNRdW90YUV4Y2VlZGVkRXJyb3JPbklvczUpIHsKICAgICAgICAgICAgICAgIC8vIFRoYW5rcyBiZSB0byBpT1M1IFByaXZhdGUgQnJvd3NpbmcgbW9kZSB3aGljaCB0aHJvd3MKICAgICAgICAgICAgICAgIC8vIFFVT1RBX0VYQ0VFREVEX0VSUlJPUiBET00gRXhjZXB0aW9uIDIyLgogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZihsb2NhbFN0b3JhZ2VSZWFsbHlXb3Jrcyl7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZih3aW5kb3cubG9jYWxTdG9yYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgX3N0b3JhZ2Vfc2VydmljZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2U7CiAgICAgICAgICAgICAgICAgICAgX2JhY2tlbmQgPSAibG9jYWxTdG9yYWdlIjsKICAgICAgICAgICAgICAgICAgICBfb2JzZXJ2ZXJfdXBkYXRlID0gX3N0b3JhZ2Vfc2VydmljZS5qU3RvcmFnZV91cGRhdGU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2goRTMpIHsvKiBGaXJlZm94IGZhaWxzIHdoZW4gdG91Y2hpbmcgbG9jYWxTdG9yYWdlIGFuZCBjb29raWVzIGFyZSBkaXNhYmxlZCAqL30KICAgICAgICB9CiAgICAgICAgLyogQ2hlY2sgaWYgYnJvd3NlciBzdXBwb3J0cyBnbG9iYWxTdG9yYWdlICovCiAgICAgICAgZWxzZSBpZigiZ2xvYmFsU3RvcmFnZSIgaW4gd2luZG93KXsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5nbG9iYWxTdG9yYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgX3N0b3JhZ2Vfc2VydmljZSA9IHdpbmRvdy5nbG9iYWxTdG9yYWdlW3dpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZV07CiAgICAgICAgICAgICAgICAgICAgX2JhY2tlbmQgPSAiZ2xvYmFsU3RvcmFnZSI7CiAgICAgICAgICAgICAgICAgICAgX29ic2VydmVyX3VwZGF0ZSA9IF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2VfdXBkYXRlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoKEU0KSB7LyogRmlyZWZveCBmYWlscyB3aGVuIHRvdWNoaW5nIGxvY2FsU3RvcmFnZSBhbmQgY29va2llcyBhcmUgZGlzYWJsZWQgKi99CiAgICAgICAgfQogICAgICAgIC8qIENoZWNrIGlmIGJyb3dzZXIgc3VwcG9ydHMgdXNlckRhdGEgYmVoYXZpb3IgKi8KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgX3N0b3JhZ2VfZWxtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGluaycpOwogICAgICAgICAgICBpZihfc3RvcmFnZV9lbG0uYWRkQmVoYXZpb3IpewoKICAgICAgICAgICAgICAgIC8qIFVzZSBhIERPTSBlbGVtZW50IHRvIGFjdCBhcyB1c2VyRGF0YSBzdG9yYWdlICovCiAgICAgICAgICAgICAgICBfc3RvcmFnZV9lbG0uc3R5bGUuYmVoYXZpb3IgPSAndXJsKCNkZWZhdWx0I3VzZXJEYXRhKSc7CgogICAgICAgICAgICAgICAgLyogdXNlckRhdGEgZWxlbWVudCBuZWVkcyB0byBiZSBpbnNlcnRlZCBpbnRvIHRoZSBET00hICovCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaGVhZCcpWzBdLmFwcGVuZENoaWxkKF9zdG9yYWdlX2VsbSk7CgogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIF9zdG9yYWdlX2VsbS5sb2FkKCJqU3RvcmFnZSIpOwogICAgICAgICAgICAgICAgfWNhdGNoKEUpewogICAgICAgICAgICAgICAgICAgIC8vIHRyeSB0byByZXNldCBjYWNoZQogICAgICAgICAgICAgICAgICAgIF9zdG9yYWdlX2VsbS5zZXRBdHRyaWJ1dGUoImpTdG9yYWdlIiwgInt9Iik7CiAgICAgICAgICAgICAgICAgICAgX3N0b3JhZ2VfZWxtLnNhdmUoImpTdG9yYWdlIik7CiAgICAgICAgICAgICAgICAgICAgX3N0b3JhZ2VfZWxtLmxvYWQoImpTdG9yYWdlIik7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFyIGRhdGEgPSAie30iOwogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfc3RvcmFnZV9lbG0uZ2V0QXR0cmlidXRlKCJqU3RvcmFnZSIpOwogICAgICAgICAgICAgICAgfWNhdGNoKEU1KXt9CgogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIF9vYnNlcnZlcl91cGRhdGUgPSBfc3RvcmFnZV9lbG0uZ2V0QXR0cmlidXRlKCJqU3RvcmFnZV91cGRhdGUiKTsKICAgICAgICAgICAgICAgIH1jYXRjaChFNil7fQoKICAgICAgICAgICAgICAgIF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2UgPSBkYXRhOwogICAgICAgICAgICAgICAgX2JhY2tlbmQgPSAidXNlckRhdGFCZWhhdmlvciI7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgX3N0b3JhZ2VfZWxtID0gbnVsbDsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gTG9hZCBkYXRhIGZyb20gc3RvcmFnZQogICAgICAgIF9sb2FkX3N0b3JhZ2UoKTsKCiAgICAgICAgLy8gcmVtb3ZlIGRlYWQga2V5cwogICAgICAgIF9oYW5kbGVUVEwoKTsKCiAgICAgICAgLy8gY3JlYXRlIGxvY2FsU3RvcmFnZSBhbmQgc2Vzc2lvblN0b3JhZ2UgcG9seWZpbGxzIGlmIG5lZWRlZAogICAgICAgIF9jcmVhdGVQb2x5ZmlsbFN0b3JhZ2UoImxvY2FsIik7CiAgICAgICAgX2NyZWF0ZVBvbHlmaWxsU3RvcmFnZSgic2Vzc2lvbiIpOwoKICAgICAgICAvLyBzdGFydCBsaXN0ZW5pbmcgZm9yIGNoYW5nZXMKICAgICAgICBfc2V0dXBPYnNlcnZlcigpOwoKICAgICAgICAvLyBpbml0aWFsaXplIHB1Ymxpc2gtc3Vic2NyaWJlIHNlcnZpY2UKICAgICAgICBfaGFuZGxlUHViU3ViKCk7CgogICAgICAgIC8vIGhhbmRsZSBjYWNoZWQgbmF2aWdhdGlvbgogICAgICAgIGlmKCJhZGRFdmVudExpc3RlbmVyIiBpbiB3aW5kb3cpewogICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicGFnZXNob3ciLCBmdW5jdGlvbihldmVudCl7CiAgICAgICAgICAgICAgICBpZihldmVudC5wZXJzaXN0ZWQpewogICAgICAgICAgICAgICAgICAgIF9zdG9yYWdlT2JzZXJ2ZXIoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgZmFsc2UpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSBhIHBvbHlmaWxsIGZvciBsb2NhbFN0b3JhZ2UgKHR5cGU9ImxvY2FsIikgb3Igc2Vzc2lvblN0b3JhZ2UgKHR5cGU9InNlc3Npb24iKQogICAgICoKICAgICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlIEVpdGhlciAibG9jYWwiIG9yICJzZXNzaW9uIgogICAgICrCoEBwYXJhbSB7Qm9vbGVhbn0gZm9yY2VDcmVhdGUgSWYgc2V0IHRvIHRydWUsIHJlY3JlYXRlIHRoZSBwb2x5ZmlsbCAobmVlZGVkIHdpdGggZmx1c2gpCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9jcmVhdGVQb2x5ZmlsbFN0b3JhZ2UodHlwZSwgZm9yY2VDcmVhdGUpewogICAgICAgIHZhciBfc2tpcFNhdmUgPSBmYWxzZSwKICAgICAgICAgICAgX2xlbmd0aCA9IDAsCiAgICAgICAgICAgIGksIAogICAgICAgICAgICBzdG9yYWdlLAogICAgICAgICAgICBzdG9yYWdlX3NvdXJjZSA9IHt9OwoKICAgICAgICAgICAgdmFyIHJhbmQgPSBNYXRoLnJhbmRvbSgpOwoKICAgICAgICBpZighZm9yY2VDcmVhdGUgJiYgdHlwZW9mIHdpbmRvd1t0eXBlKyJTdG9yYWdlIl0gIT0gInVuZGVmaW5lZCIpewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBVc2UgZ2xvYmFsU3RvcmFnZSBmb3IgbG9jYWxTdG9yYWdlIGlmIGF2YWlsYWJsZQogICAgICAgIGlmKHR5cGUgPT0gImxvY2FsIiAmJiB3aW5kb3cuZ2xvYmFsU3RvcmFnZSl7CiAgICAgICAgICAgIGxvY2FsU3RvcmFnZSA9IHdpbmRvdy5nbG9iYWxTdG9yYWdlW3dpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZV07CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIG9ubHkgSUU2LzcgZnJvbSB0aGlzIHBvaW50IG9uIAogICAgICAgIGlmKF9iYWNrZW5kICE9ICJ1c2VyRGF0YUJlaGF2aW9yIil7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIFJlbW92ZSBleGlzdGluZyBzdG9yYWdlIGVsZW1lbnQgaWYgYXZhaWxhYmxlCiAgICAgICAgaWYoZm9yY2VDcmVhdGUgJiYgd2luZG93W3R5cGUrIlN0b3JhZ2UiXSAmJiB3aW5kb3dbdHlwZSsiU3RvcmFnZSJdLnBhcmVudE5vZGUpewogICAgICAgICAgICB3aW5kb3dbdHlwZSsiU3RvcmFnZSJdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQod2luZG93W3R5cGUrIlN0b3JhZ2UiXSk7CiAgICAgICAgfQoKICAgICAgICBzdG9yYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnV0dG9uIik7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5hcHBlbmRDaGlsZChzdG9yYWdlKTsKCiAgICAgICAgaWYodHlwZSA9PSAibG9jYWwiKXsKICAgICAgICAgICAgc3RvcmFnZV9zb3VyY2UgPSBfc3RvcmFnZTsKICAgICAgICB9ZWxzZSBpZih0eXBlID09ICJzZXNzaW9uIil7CiAgICAgICAgICAgIF9zZXNzaW9uU3RvcmFnZVBvbHlmaWxsVXBkYXRlKCk7CiAgICAgICAgfQoKICAgICAgICBmb3IoaSBpbiBzdG9yYWdlX3NvdXJjZSl7CgogICAgICAgICAgICBpZihzdG9yYWdlX3NvdXJjZS5oYXNPd25Qcm9wZXJ0eShpKSAmJiBpICE9ICJfX2pzdG9yYWdlX21ldGEiICYmIGkgIT0gImxlbmd0aCIgJiYgdHlwZW9mIHN0b3JhZ2Vfc291cmNlW2ldICE9ICJ1bmRlZmluZWQiKXsKICAgICAgICAgICAgICAgIGlmKCEoaSBpbiBzdG9yYWdlKSl7CiAgICAgICAgICAgICAgICAgICAgX2xlbmd0aCsrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc3RvcmFnZVtpXSA9IHN0b3JhZ2Vfc291cmNlW2ldOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIFBvbHlmaWxsIEFQSQoKICAgICAgICAvKioKICAgICAgICAgKiBJbmRpY2F0ZXMgaG93IG1hbnkga2V5cyBhcmUgc3RvcmVkIGluIHRoZSBzdG9yYWdlCiAgICAgICAgICovCiAgICAgICAgc3RvcmFnZS5sZW5ndGggPSBfbGVuZ3RoOwoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIHRoZSBrZXkgb2YgdGhlIG50aCBzdG9yZWQgdmFsdWUKICAgICAgICAgKiAKICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gbiBJbmRleCBwb3NpdGlvbgogICAgICAgICAqIEByZXR1cm4ge1N0cmluZ30gS2V5IG5hbWUgb2YgdGhlIG50aCBzdG9yZWQgdmFsdWUKICAgICAgICAgKi8KICAgICAgICBzdG9yYWdlLmtleSA9IGZ1bmN0aW9uKG4pewogICAgICAgICAgICB2YXIgY291bnQgPSAwLCBpOwogICAgICAgICAgICBfc2Vzc2lvblN0b3JhZ2VQb2x5ZmlsbFVwZGF0ZSgpOwogICAgICAgICAgICBmb3IoaSBpbiBzdG9yYWdlX3NvdXJjZSl7CiAgICAgICAgICAgICAgICBpZihzdG9yYWdlX3NvdXJjZS5oYXNPd25Qcm9wZXJ0eShpKSAmJiBpICE9ICJfX2pzdG9yYWdlX21ldGEiICYmIGkhPSJsZW5ndGgiICYmIHR5cGVvZiBzdG9yYWdlX3NvdXJjZVtpXSAhPSAidW5kZWZpbmVkIil7CiAgICAgICAgICAgICAgICAgICAgaWYoY291bnQgPT0gbil7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb3VudCsrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIHRoZSBjdXJyZW50IHZhbHVlIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4ga2V5CiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IGtleSBuYW1lCiAgICAgICAgICogQHJldHVybiB7TWl4ZWR9IFN0b3JlZCB2YWx1ZQogICAgICAgICAqLwogICAgICAgIHN0b3JhZ2UuZ2V0SXRlbSA9IGZ1bmN0aW9uKGtleSl7CiAgICAgICAgICAgIF9zZXNzaW9uU3RvcmFnZVBvbHlmaWxsVXBkYXRlKCk7CiAgICAgICAgICAgIGlmKHR5cGUgPT0gInNlc3Npb24iKXsKICAgICAgICAgICAgICAgIHJldHVybiBzdG9yYWdlX3NvdXJjZVtrZXldOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAkLmpTdG9yYWdlLmdldChrZXkpOwogICAgICAgIH0KCiAgICAgICAgLyoqCiAgICAgICAgICogU2V0cyBvciB1cGRhdGVzIHZhbHVlIGZvciBhIGdpdmUga2V5CiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IEtleSBuYW1lIHRvIGJlIHVwZGF0ZWQKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWUgU3RyaW5nIHZhbHVlIHRvIGJlIHN0b3JlZCAKICAgICAgICAgKi8KICAgICAgICBzdG9yYWdlLnNldEl0ZW0gPSBmdW5jdGlvbihrZXksIHZhbHVlKXsKICAgICAgICAgICAgaWYodHlwZW9mIHZhbHVlID09ICJ1bmRlZmluZWQiKXsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBzdG9yYWdlW2tleV0gPSAodmFsdWUgfHwgIiIpLnRvU3RyaW5nKCk7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBSZW1vdmVzIGtleSBmcm9tIHRoZSBzdG9yYWdlCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IEtleSBuYW1lIHRvIGJlIHJlbW92ZWQKICAgICAgICAgKi8KICAgICAgICBzdG9yYWdlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbihrZXkpewogICAgICAgICAgICBpZih0eXBlID09ICJsb2NhbCIpewogICAgICAgICAgICAgICAgcmV0dXJuICQualN0b3JhZ2UuZGVsZXRlS2V5KGtleSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHN0b3JhZ2Vba2V5XSA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgCiAgICAgICAgICAgIF9za2lwU2F2ZSA9IHRydWU7CiAgICAgICAgICAgIGlmKGtleSBpbiBzdG9yYWdlKXsKICAgICAgICAgICAgICAgIHN0b3JhZ2UucmVtb3ZlQXR0cmlidXRlKGtleSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3NraXBTYXZlID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICAvKioKICAgICAgICAgKiBDbGVhciBzdG9yYWdlCiAgICAgICAgICovCiAgICAgICAgc3RvcmFnZS5jbGVhciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGlmKHR5cGUgPT0gInNlc3Npb24iKXsKICAgICAgICAgICAgICAgIHdpbmRvdy5uYW1lID0gIiI7CiAgICAgICAgICAgICAgICBfY3JlYXRlUG9seWZpbGxTdG9yYWdlKCJzZXNzaW9uIiwgdHJ1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJC5qU3RvcmFnZS5mbHVzaCgpOwogICAgICAgIH0KCiAgICAgICAgaWYodHlwZSA9PSAibG9jYWwiKXsKCiAgICAgICAgICAgIF9sb2NhbFN0b3JhZ2VQb2x5ZmlsbFNldEtleSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpewogICAgICAgICAgICAgICAgaWYoa2V5ID09ICJsZW5ndGgiKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfc2tpcFNhdmUgPSB0cnVlOwogICAgICAgICAgICAgICAgaWYodHlwZW9mIHZhbHVlID09ICJ1bmRlZmluZWQiKXsKICAgICAgICAgICAgICAgICAgICBpZihrZXkgaW4gc3RvcmFnZSl7CiAgICAgICAgICAgICAgICAgICAgICAgIF9sZW5ndGgtLTsKICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZS5yZW1vdmVBdHRyaWJ1dGUoa2V5KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBpZighKGtleSBpbiBzdG9yYWdlKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIF9sZW5ndGgrKzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgc3RvcmFnZVtrZXldID0gKHZhbHVlIHx8ICIiKS50b1N0cmluZygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgc3RvcmFnZS5sZW5ndGggPSBfbGVuZ3RoOwogICAgICAgICAgICAgICAgX3NraXBTYXZlID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIF9zZXNzaW9uU3RvcmFnZVBvbHlmaWxsVXBkYXRlKCl7CiAgICAgICAgICAgICAgICBpZih0eXBlICE9ICJzZXNzaW9uIil7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgICAgIHN0b3JhZ2Vfc291cmNlID0gSlNPTi5wYXJzZSh3aW5kb3cubmFtZSB8fCAie30iKTsKICAgICAgICAgICAgICAgIH1jYXRjaChFKXsKICAgICAgICAgICAgICAgICAgICBzdG9yYWdlX3NvdXJjZSA9IHt9OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIF9zZXNzaW9uU3RvcmFnZVBvbHlmaWxsU2F2ZSgpewogICAgICAgICAgICBpZih0eXBlICE9ICJzZXNzaW9uIil7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgd2luZG93Lm5hbWUgPSBKU09OLnN0cmluZ2lmeShzdG9yYWdlX3NvdXJjZSk7CiAgICAgICAgfTsKCiAgICAgICAgc3RvcmFnZS5hdHRhY2hFdmVudCgib25wcm9wZXJ0eWNoYW5nZSIsIGZ1bmN0aW9uKGUpewogICAgICAgICAgICBpZihlLnByb3BlcnR5TmFtZSA9PSAibGVuZ3RoIil7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKF9za2lwU2F2ZSB8fCBlLnByb3BlcnR5TmFtZSA9PSAibGVuZ3RoIil7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKHR5cGUgPT0gImxvY2FsIil7CiAgICAgICAgICAgICAgICBpZighKGUucHJvcGVydHlOYW1lIGluIHN0b3JhZ2Vfc291cmNlKSAmJiB0eXBlb2Ygc3RvcmFnZVtlLnByb3BlcnR5TmFtZV0gIT0gInVuZGVmaW5lZCIpewogICAgICAgICAgICAgICAgICAgIF9sZW5ndGggKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH1lbHNlIGlmKHR5cGUgPT0gInNlc3Npb24iKXsKICAgICAgICAgICAgICAgIF9zZXNzaW9uU3RvcmFnZVBvbHlmaWxsVXBkYXRlKCk7CiAgICAgICAgICAgICAgICBpZih0eXBlb2Ygc3RvcmFnZVtlLnByb3BlcnR5TmFtZV0gIT0gInVuZGVmaW5lZCIgJiYgIShlLnByb3BlcnR5TmFtZSBpbiBzdG9yYWdlX3NvdXJjZSkpewogICAgICAgICAgICAgICAgICAgIHN0b3JhZ2Vfc291cmNlW2UucHJvcGVydHlOYW1lXSA9IHN0b3JhZ2VbZS5wcm9wZXJ0eU5hbWVdOwogICAgICAgICAgICAgICAgICAgIF9sZW5ndGgrKzsKICAgICAgICAgICAgICAgIH1lbHNlIGlmKHR5cGVvZiBzdG9yYWdlW2UucHJvcGVydHlOYW1lXSA9PSAidW5kZWZpbmVkIiAmJiBlLnByb3BlcnR5TmFtZSBpbiBzdG9yYWdlX3NvdXJjZSl7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHN0b3JhZ2Vfc291cmNlW2UucHJvcGVydHlOYW1lXTsKICAgICAgICAgICAgICAgICAgICBfbGVuZ3RoLS07CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBzdG9yYWdlX3NvdXJjZVtlLnByb3BlcnR5TmFtZV0gPSBzdG9yYWdlW2UucHJvcGVydHlOYW1lXTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfc2Vzc2lvblN0b3JhZ2VQb2x5ZmlsbFNhdmUoKTsKICAgICAgICAgICAgICAgIHN0b3JhZ2UubGVuZ3RoID0gX2xlbmd0aDsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJC5qU3RvcmFnZS5zZXQoZS5wcm9wZXJ0eU5hbWUsIHN0b3JhZ2VbZS5wcm9wZXJ0eU5hbWVdKTsKICAgICAgICAgICAgc3RvcmFnZS5sZW5ndGggPSBfbGVuZ3RoOwogICAgICAgIH0pOwoKICAgICAgICB3aW5kb3dbdHlwZSsiU3RvcmFnZSJdID0gc3RvcmFnZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbG9hZCBkYXRhIGZyb20gc3RvcmFnZSB3aGVuIG5lZWRlZAogICAgICovCiAgICBmdW5jdGlvbiBfcmVsb2FkRGF0YSgpewogICAgICAgIHZhciBkYXRhID0gInt9IjsKCiAgICAgICAgaWYoX2JhY2tlbmQgPT0gInVzZXJEYXRhQmVoYXZpb3IiKXsKICAgICAgICAgICAgX3N0b3JhZ2VfZWxtLmxvYWQoImpTdG9yYWdlIik7CgogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICBkYXRhID0gX3N0b3JhZ2VfZWxtLmdldEF0dHJpYnV0ZSgialN0b3JhZ2UiKTsKICAgICAgICAgICAgfWNhdGNoKEU1KXt9CgogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICBfb2JzZXJ2ZXJfdXBkYXRlID0gX3N0b3JhZ2VfZWxtLmdldEF0dHJpYnV0ZSgialN0b3JhZ2VfdXBkYXRlIik7CiAgICAgICAgICAgIH1jYXRjaChFNil7fQoKICAgICAgICAgICAgX3N0b3JhZ2Vfc2VydmljZS5qU3RvcmFnZSA9IGRhdGE7CiAgICAgICAgfQoKICAgICAgICBfbG9hZF9zdG9yYWdlKCk7CgogICAgICAgIC8vIHJlbW92ZSBkZWFkIGtleXMKICAgICAgICBfaGFuZGxlVFRMKCk7CgogICAgICAgIF9oYW5kbGVQdWJTdWIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHMgdXAgYSBzdG9yYWdlIGNoYW5nZSBvYnNlcnZlcgogICAgICovCiAgICBmdW5jdGlvbiBfc2V0dXBPYnNlcnZlcigpewogICAgICAgIGlmKF9iYWNrZW5kID09ICJsb2NhbFN0b3JhZ2UiIHx8IF9iYWNrZW5kID09ICJnbG9iYWxTdG9yYWdlIil7CiAgICAgICAgICAgIGlmKCJhZGRFdmVudExpc3RlbmVyIiBpbiB3aW5kb3cpewogICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInN0b3JhZ2UiLCBfc3RvcmFnZU9ic2VydmVyLCBmYWxzZSk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgZG9jdW1lbnQuYXR0YWNoRXZlbnQoIm9uc3RvcmFnZSIsIF9zdG9yYWdlT2JzZXJ2ZXIpOwogICAgICAgICAgICB9CiAgICAgICAgfWVsc2UgaWYoX2JhY2tlbmQgPT0gInVzZXJEYXRhQmVoYXZpb3IiKXsKICAgICAgICAgICAgc2V0SW50ZXJ2YWwoX3N0b3JhZ2VPYnNlcnZlciwgMTAwMCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRmlyZWQgb24gYW55IGtpbmQgb2YgZGF0YSBjaGFuZ2UsIG5lZWRzIHRvIGNoZWNrIGlmIGFueXRoaW5nIGhhcwogICAgICogcmVhbGx5IGJlZW4gY2hhbmdlZAogICAgICovCiAgICBmdW5jdGlvbiBfc3RvcmFnZU9ic2VydmVyKCl7CiAgICAgICAgdmFyIHVwZGF0ZVRpbWU7CiAgICAgICAgLy8gY3VtdWxhdGUgY2hhbmdlIG5vdGlmaWNhdGlvbnMgd2l0aCB0aW1lb3V0CiAgICAgICAgY2xlYXJUaW1lb3V0KF9vYnNlcnZlcl90aW1lb3V0KTsKICAgICAgICBfb2JzZXJ2ZXJfdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXsKCiAgICAgICAgICAgIGlmKF9iYWNrZW5kID09ICJsb2NhbFN0b3JhZ2UiIHx8IF9iYWNrZW5kID09ICJnbG9iYWxTdG9yYWdlIil7CiAgICAgICAgICAgICAgICB1cGRhdGVUaW1lID0gX3N0b3JhZ2Vfc2VydmljZS5qU3RvcmFnZV91cGRhdGU7CiAgICAgICAgICAgIH1lbHNlIGlmKF9iYWNrZW5kID09ICJ1c2VyRGF0YUJlaGF2aW9yIil7CiAgICAgICAgICAgICAgICBfc3RvcmFnZV9lbG0ubG9hZCgialN0b3JhZ2UiKTsKICAgICAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVUaW1lID0gX3N0b3JhZ2VfZWxtLmdldEF0dHJpYnV0ZSgialN0b3JhZ2VfdXBkYXRlIik7CiAgICAgICAgICAgICAgICB9Y2F0Y2goRTUpe30KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYodXBkYXRlVGltZSAmJiB1cGRhdGVUaW1lICE9IF9vYnNlcnZlcl91cGRhdGUpewogICAgICAgICAgICAgICAgX29ic2VydmVyX3VwZGF0ZSA9IHVwZGF0ZVRpbWU7CiAgICAgICAgICAgICAgICBfY2hlY2tVcGRhdGVkS2V5cygpOwogICAgICAgICAgICB9CgogICAgICAgIH0sIDI1KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbG9hZHMgdGhlIGRhdGEgYW5kIGNoZWNrcyBpZiBhbnkga2V5cyBhcmUgY2hhbmdlZAogICAgICovCiAgICBmdW5jdGlvbiBfY2hlY2tVcGRhdGVkS2V5cygpewogICAgICAgIHZhciBvbGRDcmMzMkxpc3QgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KF9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5DUkMzMikpLAogICAgICAgICAgICBuZXdDcmMzMkxpc3Q7CgogICAgICAgIF9yZWxvYWREYXRhKCk7CiAgICAgICAgbmV3Q3JjMzJMaXN0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEuQ1JDMzIpKTsKCiAgICAgICAgdmFyIGtleSwKICAgICAgICAgICAgdXBkYXRlZCA9IFtdLAogICAgICAgICAgICByZW1vdmVkID0gW107CgogICAgICAgIGZvcihrZXkgaW4gb2xkQ3JjMzJMaXN0KXsKICAgICAgICAgICAgaWYob2xkQ3JjMzJMaXN0Lmhhc093blByb3BlcnR5KGtleSkpewogICAgICAgICAgICAgICAgaWYoIW5ld0NyYzMyTGlzdFtrZXldKXsKICAgICAgICAgICAgICAgICAgICByZW1vdmVkLnB1c2goa2V5KTsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKG9sZENyYzMyTGlzdFtrZXldICE9IG5ld0NyYzMyTGlzdFtrZXldKXsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVkLnB1c2goa2V5KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yKGtleSBpbiBuZXdDcmMzMkxpc3QpewogICAgICAgICAgICBpZihuZXdDcmMzMkxpc3QuaGFzT3duUHJvcGVydHkoa2V5KSl7CiAgICAgICAgICAgICAgICBpZighb2xkQ3JjMzJMaXN0W2tleV0pewogICAgICAgICAgICAgICAgICAgIHVwZGF0ZWQucHVzaChrZXkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBfZmlyZU9ic2VydmVycyh1cGRhdGVkLCAidXBkYXRlZCIpOwogICAgICAgIF9maXJlT2JzZXJ2ZXJzKHJlbW92ZWQsICJkZWxldGVkIik7CiAgICB9CgogICAgLyoqCiAgICAgKiBGaXJlcyBvYnNlcnZlcnMgZm9yIHVwZGF0ZWQga2V5cwogICAgICoKICAgICAqIEBwYXJhbSB7QXJyYXl8U3RyaW5nfSBrZXlzIEFycmF5IG9mIGtleSBuYW1lcyBvciBhIGtleQogICAgICogQHBhcmFtIHtTdHJpbmd9IGFjdGlvbiBXaGF0IGhhcHBlbmVkIHdpdGggdGhlIHZhbHVlICh1cGRhdGVkLCBkZWxldGVkLCBmbHVzaGVkKQogICAgICovCiAgICBmdW5jdGlvbiBfZmlyZU9ic2VydmVycyhrZXlzLCBhY3Rpb24pewogICAgICAgIGtleXMgPSBbXS5jb25jYXQoa2V5cyB8fCBbXSk7CiAgICAgICAgaWYoYWN0aW9uID09ICJmbHVzaGVkIil7CiAgICAgICAgICAgIGtleXMgPSBbXTsKICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gX29ic2VydmVycyl7CiAgICAgICAgICAgICAgICBpZihfb2JzZXJ2ZXJzLmhhc093blByb3BlcnR5KGtleSkpewogICAgICAgICAgICAgICAgICAgIGtleXMucHVzaChrZXkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGFjdGlvbiA9ICJkZWxldGVkIjsKICAgICAgICB9CiAgICAgICAgZm9yKHZhciBpPTAsIGxlbiA9IGtleXMubGVuZ3RoOyBpPGxlbjsgaSsrKXsKICAgICAgICAgICAgaWYoX29ic2VydmVyc1trZXlzW2ldXSl7CiAgICAgICAgICAgICAgICBmb3IodmFyIGo9MCwgamxlbiA9IF9vYnNlcnZlcnNba2V5c1tpXV0ubGVuZ3RoOyBqPGpsZW47IGorKyl7CiAgICAgICAgICAgICAgICAgICAgX29ic2VydmVyc1trZXlzW2ldXVtqXShrZXlzW2ldLCBhY3Rpb24pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUHVibGlzaGVzIGtleSBjaGFuZ2UgdG8gbGlzdGVuZXJzCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9wdWJsaXNoQ2hhbmdlKCl7CiAgICAgICAgdmFyIHVwZGF0ZVRpbWUgPSAoK25ldyBEYXRlKCkpLnRvU3RyaW5nKCk7CgogICAgICAgIGlmKF9iYWNrZW5kID09ICJsb2NhbFN0b3JhZ2UiIHx8IF9iYWNrZW5kID09ICJnbG9iYWxTdG9yYWdlIil7CiAgICAgICAgICAgIF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2VfdXBkYXRlID0gdXBkYXRlVGltZTsKICAgICAgICB9ZWxzZSBpZihfYmFja2VuZCA9PSAidXNlckRhdGFCZWhhdmlvciIpewogICAgICAgICAgICBfc3RvcmFnZV9lbG0uc2V0QXR0cmlidXRlKCJqU3RvcmFnZV91cGRhdGUiLCB1cGRhdGVUaW1lKTsKICAgICAgICAgICAgX3N0b3JhZ2VfZWxtLnNhdmUoImpTdG9yYWdlIik7CiAgICAgICAgfQoKICAgICAgICBfc3RvcmFnZU9ic2VydmVyKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkcyB0aGUgZGF0YSBmcm9tIHRoZSBzdG9yYWdlIGJhc2VkIG9uIHRoZSBzdXBwb3J0ZWQgbWVjaGFuaXNtCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9sb2FkX3N0b3JhZ2UoKXsKICAgICAgICAvKiBpZiBqU3RvcmFnZSBzdHJpbmcgaXMgcmV0cmlldmVkLCB0aGVuIGRlY29kZSBpdCAqLwogICAgICAgIGlmKF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2UpewogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICBfc3RvcmFnZSA9IEpTT04ucGFyc2UoU3RyaW5nKF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2UpKTsKICAgICAgICAgICAgfWNhdGNoKEU2KXtfc3RvcmFnZV9zZXJ2aWNlLmpTdG9yYWdlID0gInt9Ijt9CiAgICAgICAgfWVsc2V7CiAgICAgICAgICAgIF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2UgPSAie30iOwogICAgICAgIH0KICAgICAgICBfc3RvcmFnZV9zaXplID0gX3N0b3JhZ2Vfc2VydmljZS5qU3RvcmFnZT9TdHJpbmcoX3N0b3JhZ2Vfc2VydmljZS5qU3RvcmFnZSkubGVuZ3RoOjA7CgogICAgICAgIGlmKCFfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEpewogICAgICAgICAgICBfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEgPSB7fTsKICAgICAgICB9CiAgICAgICAgaWYoIV9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5DUkMzMil7CiAgICAgICAgICAgIF9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5DUkMzMiA9IHt9OwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgZnVuY3Rpb25zIHByb3ZpZGVzIHRoZSAic2F2ZSIgbWVjaGFuaXNtIHRvIHN0b3JlIHRoZSBqU3RvcmFnZSBvYmplY3QKICAgICAqLwogICAgZnVuY3Rpb24gX3NhdmUoKXsKICAgICAgICBfZHJvcE9sZEV2ZW50cygpOyAvLyByZW1vdmUgZXhwaXJlZCBldmVudHMKICAgICAgICB0cnl7CiAgICAgICAgICAgIF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2UgPSBKU09OLnN0cmluZ2lmeShfc3RvcmFnZSk7CiAgICAgICAgICAgIC8vIElmIHVzZXJEYXRhIGlzIHVzZWQgYXMgdGhlIHN0b3JhZ2UgZW5naW5lLCBhZGRpdGlvbmFsCiAgICAgICAgICAgIGlmKF9zdG9yYWdlX2VsbSkgewogICAgICAgICAgICAgICAgX3N0b3JhZ2VfZWxtLnNldEF0dHJpYnV0ZSgialN0b3JhZ2UiLF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2UpOwogICAgICAgICAgICAgICAgX3N0b3JhZ2VfZWxtLnNhdmUoImpTdG9yYWdlIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3N0b3JhZ2Vfc2l6ZSA9IF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2U/U3RyaW5nKF9zdG9yYWdlX3NlcnZpY2UualN0b3JhZ2UpLmxlbmd0aDowOwogICAgICAgIH1jYXRjaChFNyl7LyogcHJvYmFibHkgY2FjaGUgaXMgZnVsbCwgbm90aGluZyBpcyBzYXZlZCB0aGlzIHdheSovfQogICAgfQoKICAgIC8qKgogICAgICogRnVuY3Rpb24gY2hlY2tzIGlmIGEga2V5IGlzIHNldCBhbmQgaXMgc3RyaW5nIG9yIG51bWJlcmljCiAgICAgKgogICAgICogQHBhcmFtIHtTdHJpbmd9IGtleSBLZXkgbmFtZQogICAgICovCiAgICBmdW5jdGlvbiBfY2hlY2tLZXkoa2V5KXsKICAgICAgICBpZigha2V5IHx8ICh0eXBlb2Yga2V5ICE9ICJzdHJpbmciICYmIHR5cGVvZiBrZXkgIT0gIm51bWJlciIpKXsKICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignS2V5IG5hbWUgbXVzdCBiZSBzdHJpbmcgb3IgbnVtZXJpYycpOwogICAgICAgIH0KICAgICAgICBpZihrZXkgPT0gIl9fanN0b3JhZ2VfbWV0YSIpewogICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdSZXNlcnZlZCBrZXkgbmFtZScpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZXMgZXhwaXJlZCBrZXlzCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9oYW5kbGVUVEwoKXsKICAgICAgICB2YXIgY3VydGltZSwgaSwgVFRMLCBDUkMzMiwgbmV4dEV4cGlyZSA9IEluZmluaXR5LCBjaGFuZ2VkID0gZmFsc2UsIGRlbGV0ZWQgPSBbXTsKCiAgICAgICAgY2xlYXJUaW1lb3V0KF90dGxfdGltZW91dCk7CgogICAgICAgIGlmKCFfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEgfHwgdHlwZW9mIF9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5UVEwgIT0gIm9iamVjdCIpewogICAgICAgICAgICAvLyBub3RoaW5nIHRvIGRvIGhlcmUKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY3VydGltZSA9ICtuZXcgRGF0ZSgpOwogICAgICAgIFRUTCA9IF9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5UVEw7CgogICAgICAgIENSQzMyID0gX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLkNSQzMyOwogICAgICAgIGZvcihpIGluIFRUTCl7CiAgICAgICAgICAgIGlmKFRUTC5oYXNPd25Qcm9wZXJ0eShpKSl7CiAgICAgICAgICAgICAgICBpZihUVExbaV0gPD0gY3VydGltZSl7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIFRUTFtpXTsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgQ1JDMzJbaV07CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF9zdG9yYWdlW2ldOwogICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgIGRlbGV0ZWQucHVzaChpKTsKICAgICAgICAgICAgICAgIH1lbHNlIGlmKFRUTFtpXSA8IG5leHRFeHBpcmUpewogICAgICAgICAgICAgICAgICAgIG5leHRFeHBpcmUgPSBUVExbaV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIHNldCBuZXh0IGNoZWNrCiAgICAgICAgaWYobmV4dEV4cGlyZSAhPSBJbmZpbml0eSl7CiAgICAgICAgICAgIF90dGxfdGltZW91dCA9IHNldFRpbWVvdXQoX2hhbmRsZVRUTCwgbmV4dEV4cGlyZSAtIGN1cnRpbWUpOwogICAgICAgIH0KCiAgICAgICAgLy8gc2F2ZSBjaGFuZ2VzCiAgICAgICAgaWYoY2hhbmdlZCl7CiAgICAgICAgICAgIF9zYXZlKCk7CiAgICAgICAgICAgIF9wdWJsaXNoQ2hhbmdlKCk7CiAgICAgICAgICAgIF9maXJlT2JzZXJ2ZXJzKGRlbGV0ZWQsICJkZWxldGVkIik7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQ2hlY2tzIGlmIHRoZXJlJ3MgYW55IGV2ZW50cyBvbiBob2xkIHRvIGJlIGZpcmVkIHRvIGxpc3RlbmVycwogICAgICovCiAgICBmdW5jdGlvbiBfaGFuZGxlUHViU3ViKCl7CiAgICAgICAgaWYoIV9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5QdWJTdWIpewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciBwdWJlbG0sCiAgICAgICAgICAgIF9wdWJzdWJDdXJyZW50ID0gX3B1YnN1Yl9sYXN0OwoKICAgICAgICBmb3IodmFyIGk9bGVuPV9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5QdWJTdWIubGVuZ3RoLTE7IGk+PTA7IGktLSl7CiAgICAgICAgICAgIHB1YmVsbSA9IF9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5QdWJTdWJbaV07CiAgICAgICAgICAgIGlmKHB1YmVsbVswXSA+IF9wdWJzdWJfbGFzdCl7CiAgICAgICAgICAgICAgICBfcHVic3ViQ3VycmVudCA9IHB1YmVsbVswXTsKICAgICAgICAgICAgICAgIF9maXJlU3Vic2NyaWJlcnMocHViZWxtWzFdLCBwdWJlbG1bMl0pOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBfcHVic3ViX2xhc3QgPSBfcHVic3ViQ3VycmVudDsKICAgIH0KCiAgICAvKioKICAgICAqIEZpcmVzIGFsbCBzdWJzY3JpYmVyIGxpc3RlbmVycyBmb3IgYSBwdWJzdWIgY2hhbm5lbAogICAgICoKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGFubmVsIENoYW5uZWwgbmFtZQogICAgICogQHBhcmFtIHtNaXhlZH0gcGF5bG9hZCBQYXlsb2FkIGRhdGEgdG8gZGVsaXZlcgogICAgICovCiAgICBmdW5jdGlvbiBfZmlyZVN1YnNjcmliZXJzKGNoYW5uZWwsIHBheWxvYWQpewogICAgICAgIGlmKF9wdWJzdWJfb2JzZXJ2ZXJzW2NoYW5uZWxdKXsKICAgICAgICAgICAgZm9yKHZhciBpPTAsIGxlbiA9IF9wdWJzdWJfb2JzZXJ2ZXJzW2NoYW5uZWxdLmxlbmd0aDsgaTxsZW47IGkrKyl7CiAgICAgICAgICAgICAgICAvLyBzZW5kIGltbXV0YWJsZSBkYXRhIHRoYXQgY2FuJ3QgYmUgbW9kaWZpZWQgYnkgbGlzdGVuZXJzCiAgICAgICAgICAgICAgICBfcHVic3ViX29ic2VydmVyc1tjaGFubmVsXVtpXShjaGFubmVsLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUgb2xkIGV2ZW50cyBmcm9tIHRoZSBwdWJsaXNoIHN0cmVhbSAoYXQgbGVhc3QgMnNlYyBvbGQpCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9kcm9wT2xkRXZlbnRzKCl7CiAgICAgICAgaWYoIV9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5QdWJTdWIpewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgcmV0aXJlID0gK25ldyBEYXRlKCkgLSAyMDAwOwoKICAgICAgICBmb3IodmFyIGk9MCwgbGVuID0gX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlB1YlN1Yi5sZW5ndGg7IGk8bGVuOyBpKyspewogICAgICAgICAgICBpZihfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEuUHViU3ViW2ldWzBdIDw9IHJldGlyZSl7CiAgICAgICAgICAgICAgICAvLyBkZWxldGVDb3VudCBpcyBuZWVkZWQgZm9yIElFNgogICAgICAgICAgICAgICAgX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlB1YlN1Yi5zcGxpY2UoaSwgX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlB1YlN1Yi5sZW5ndGggLSBpKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZighX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlB1YlN1Yi5sZW5ndGgpewogICAgICAgICAgICBkZWxldGUgX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlB1YlN1YjsKICAgICAgICB9CgogICAgfQoKICAgIC8qKgogICAgICogUHVibGlzaCBwYXlsb2FkIHRvIGEgY2hhbm5lbAogICAgICoKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGFubmVsIENoYW5uZWwgbmFtZQogICAgICogQHBhcmFtIHtNaXhlZH0gcGF5bG9hZCBQYXlsb2FkIHRvIHNlbmQgdG8gdGhlIHN1YnNjcmliZXJzCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9wdWJsaXNoKGNoYW5uZWwsIHBheWxvYWQpewogICAgICAgIGlmKCFfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEpewogICAgICAgICAgICBfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEgPSB7fTsKICAgICAgICB9CiAgICAgICAgaWYoIV9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5QdWJTdWIpewogICAgICAgICAgICBfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEuUHViU3ViID0gW107CiAgICAgICAgfQogICAgICAgIAogICAgICAgIF9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5QdWJTdWIudW5zaGlmdChbK25ldyBEYXRlLCBjaGFubmVsLCBwYXlsb2FkXSk7CgogICAgICAgIF9zYXZlKCk7CiAgICAgICAgX3B1Ymxpc2hDaGFuZ2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENSQzMyIGNhbGN1bGF0aW9uIGJhc2VkIG9uIGh0dHA6Ly9ub3Rlc2xvZy5jb20vcG9zdC9jcmMzMi1mb3ItamF2YXNjcmlwdC8KICAgICAqCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyIFN0cmluZyB0byBiZSBoYXNoZWQKICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbY3JjXSBMYXN0IGNyYyB2YWx1ZSBpbiBjYXNlIG9mIHN0cmVhbXMKICAgICAqLwogICAgZnVuY3Rpb24gX2NyYzMyKHN0ciwgY3JjKXsKICAgICAgICBjcmMgPSBjcmMgfHwgMDsKCiAgICAgICAgdmFyIG4gPSAwLCAvL2EgbnVtYmVyIGJldHdlZW4gMCBhbmQgMjU1CiAgICAgICAgICAgIHggPSAwOyAvL2FuIGhleCBudW1iZXIKIAogICAgICAgIGNyYyA9IGNyYyBeICgtMSk7CiAgICAgICAgZm9yKHZhciBpID0gMCwgbGVuID0gc3RyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKXsKICAgICAgICAgICAgbiA9IChjcmMgXiBzdHIuY2hhckNvZGVBdChpKSkgJiAweEZGOwogICAgICAgICAgICB4ID0gIjB4IiArIF9jcmMzMlRhYmxlLnN1YnN0cihuICogOSwgOCk7CiAgICAgICAgICAgIGNyYyA9IChjcmMgPj4+IDgpXng7CiAgICAgICAgfQogICAgICAgIHJldHVybiBjcmNeKC0xKTsKICAgIH0KCiAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyBQVUJMSUMgSU5URVJGQUNFIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAkLmpTdG9yYWdlID0gewogICAgICAgIC8qIFZlcnNpb24gbnVtYmVyICovCiAgICAgICAgdmVyc2lvbjogSlNUT1JBR0VfVkVSU0lPTiwKCiAgICAgICAgLyoqCiAgICAgICAgICogU2V0cyBhIGtleSdzIHZhbHVlLgogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGtleSBLZXkgdG8gc2V0LiBJZiB0aGlzIHZhbHVlIGlzIG5vdCBzZXQgb3Igbm90CiAgICAgICAgICogICAgICAgICAgICAgIGEgc3RyaW5nIGFuIGV4Y2VwdGlvbiBpcyByYWlzZWQuCiAgICAgICAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVmFsdWUgdG8gc2V0LiBUaGlzIGNhbiBiZSBhbnkgdmFsdWUgdGhhdCBpcyBKU09OCiAgICAgICAgICogICAgICAgICAgICAgIGNvbXBhdGlibGUgKE51bWJlcnMsIFN0cmluZ3MsIE9iamVjdHMgZXRjLikuCiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSAtIHBvc3NpYmxlIG9wdGlvbnMgdG8gdXNlCiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IFtvcHRpb25zLlRUTF0gLSBvcHRpb25hbCBUVEwgdmFsdWUKICAgICAgICAgKiBAcmV0dXJuIHtNaXhlZH0gdGhlIHVzZWQgdmFsdWUKICAgICAgICAgKi8KICAgICAgICBzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUsIG9wdGlvbnMpewogICAgICAgICAgICBfY2hlY2tLZXkoa2V5KTsKCiAgICAgICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICAgICAgICAgICAgLy8gdW5kZWZpbmVkIHZhbHVlcyBhcmUgZGVsZXRlZCBhdXRvbWF0aWNhbGx5CiAgICAgICAgICAgIGlmKHR5cGVvZiB2YWx1ZSA9PSAidW5kZWZpbmVkIil7CiAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUtleShrZXkpOwogICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihfWE1MU2VydmljZS5pc1hNTCh2YWx1ZSkpewogICAgICAgICAgICAgICAgdmFsdWUgPSB7X2lzX3htbDp0cnVlLHhtbDpfWE1MU2VydmljZS5lbmNvZGUodmFsdWUpfTsKICAgICAgICAgICAgfWVsc2UgaWYodHlwZW9mIHZhbHVlID09ICJmdW5jdGlvbiIpewogICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsgLy8gZnVuY3Rpb25zIGNhbid0IGJlIHNhdmVkIQogICAgICAgICAgICB9ZWxzZSBpZih2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT0gIm9iamVjdCIpewogICAgICAgICAgICAgICAgLy8gY2xvbmUgdGhlIG9iamVjdCBiZWZvcmUgc2F2aW5nIHRvIF9zdG9yYWdlIHRyZWUKICAgICAgICAgICAgICAgIHZhbHVlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfc3RvcmFnZVtrZXldID0gdmFsdWU7CgogICAgICAgICAgICBfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEuQ1JDMzJba2V5XSA9IF9jcmMzMihKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwoKICAgICAgICAgICAgdGhpcy5zZXRUVEwoa2V5LCBvcHRpb25zLlRUTCB8fCAwKTsgLy8gYWxzbyBoYW5kbGVzIHNhdmluZyBhbmQgX3B1Ymxpc2hDaGFuZ2UKCiAgICAgICAgICAgIF9sb2NhbFN0b3JhZ2VQb2x5ZmlsbFNldEtleShrZXksIHZhbHVlKTsKCiAgICAgICAgICAgIF9maXJlT2JzZXJ2ZXJzKGtleSwgInVwZGF0ZWQiKTsKICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIExvb2tzIHVwIGEga2V5IGluIGNhY2hlCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IC0gS2V5IHRvIGxvb2sgdXAuCiAgICAgICAgICogQHBhcmFtIHttaXhlZH0gZGVmIC0gRGVmYXVsdCB2YWx1ZSB0byByZXR1cm4sIGlmIGtleSBkaWRuJ3QgZXhpc3QuCiAgICAgICAgICogQHJldHVybiB7TWl4ZWR9IHRoZSBrZXkgdmFsdWUsIGRlZmF1bHQgdmFsdWUgb3IgbnVsbAogICAgICAgICAqLwogICAgICAgIGdldDogZnVuY3Rpb24oa2V5LCBkZWYpewogICAgICAgICAgICBfY2hlY2tLZXkoa2V5KTsKICAgICAgICAgICAgaWYoa2V5IGluIF9zdG9yYWdlKXsKICAgICAgICAgICAgICAgIGlmKF9zdG9yYWdlW2tleV0gJiYgdHlwZW9mIF9zdG9yYWdlW2tleV0gPT0gIm9iamVjdCIgJiYKICAgICAgICAgICAgICAgICAgICAgICAgX3N0b3JhZ2Vba2V5XS5faXNfeG1sICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3RvcmFnZVtrZXldLl9pc194bWwpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBfWE1MU2VydmljZS5kZWNvZGUoX3N0b3JhZ2Vba2V5XS54bWwpOwogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9zdG9yYWdlW2tleV07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHR5cGVvZihkZWYpID09ICd1bmRlZmluZWQnID8gbnVsbCA6IGRlZjsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBEZWxldGVzIGEga2V5IGZyb20gY2FjaGUuCiAgICAgICAgICoKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30ga2V5IC0gS2V5IHRvIGRlbGV0ZS4KICAgICAgICAgKiBAcmV0dXJuIHtCb29sZWFufSB0cnVlIGlmIGtleSBleGlzdGVkIG9yIGZhbHNlIGlmIGl0IGRpZG4ndAogICAgICAgICAqLwogICAgICAgIGRlbGV0ZUtleTogZnVuY3Rpb24oa2V5KXsKICAgICAgICAgICAgX2NoZWNrS2V5KGtleSk7CiAgICAgICAgICAgIGlmKGtleSBpbiBfc3RvcmFnZSl7CiAgICAgICAgICAgICAgICBkZWxldGUgX3N0b3JhZ2Vba2V5XTsKICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBmcm9tIFRUTCBsaXN0CiAgICAgICAgICAgICAgICBpZih0eXBlb2YgX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlRUTCA9PSAib2JqZWN0IiAmJgogICAgICAgICAgICAgICAgICBrZXkgaW4gX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlRUTCl7CiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5UVExba2V5XTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBkZWxldGUgX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLkNSQzMyW2tleV07CiAgICAgICAgICAgICAgICBfbG9jYWxTdG9yYWdlUG9seWZpbGxTZXRLZXkoa2V5LCB1bmRlZmluZWQpOwoKICAgICAgICAgICAgICAgIF9zYXZlKCk7CiAgICAgICAgICAgICAgICBfcHVibGlzaENoYW5nZSgpOwogICAgICAgICAgICAgICAgX2ZpcmVPYnNlcnZlcnMoa2V5LCAiZGVsZXRlZCIpOwogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIFNldHMgYSBUVEwgZm9yIGEga2V5LCBvciByZW1vdmUgaXQgaWYgdHRsIHZhbHVlIGlzIDAgb3IgYmVsb3cKICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBrZXkgLSBrZXkgdG8gc2V0IHRoZSBUVEwgZm9yCiAgICAgICAgICogQHBhcmFtIHtOdW1iZXJ9IHR0bCAtIFRUTCB0aW1lb3V0IGluIG1pbGxpc2Vjb25kcwogICAgICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IHRydWUgaWYga2V5IGV4aXN0ZWQgb3IgZmFsc2UgaWYgaXQgZGlkbid0CiAgICAgICAgICovCiAgICAgICAgc2V0VFRMOiBmdW5jdGlvbihrZXksIHR0bCl7CiAgICAgICAgICAgIHZhciBjdXJ0aW1lID0gK25ldyBEYXRlKCk7CiAgICAgICAgICAgIF9jaGVja0tleShrZXkpOwogICAgICAgICAgICB0dGwgPSBOdW1iZXIodHRsKSB8fCAwOwogICAgICAgICAgICBpZihrZXkgaW4gX3N0b3JhZ2UpewoKICAgICAgICAgICAgICAgIGlmKCFfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEuVFRMKXsKICAgICAgICAgICAgICAgICAgICBfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEuVFRMID0ge307CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gU2V0IFRUTCB2YWx1ZSBmb3IgdGhlIGtleQogICAgICAgICAgICAgICAgaWYodHRsPjApewogICAgICAgICAgICAgICAgICAgIF9zdG9yYWdlLl9fanN0b3JhZ2VfbWV0YS5UVExba2V5XSA9IGN1cnRpbWUgKyB0dGw7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBkZWxldGUgX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlRUTFtrZXldOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9zYXZlKCk7CgogICAgICAgICAgICAgICAgX2hhbmRsZVRUTCgpOwoKICAgICAgICAgICAgICAgIF9wdWJsaXNoQ2hhbmdlKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogR2V0cyByZW1haW5pbmcgVFRMIChpbiBtaWxsaXNlY29uZHMpIGZvciBhIGtleSBvciAwIHdoZW4gbm8gVFRMIGhhcyBiZWVuIHNldAogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGtleSBLZXkgdG8gY2hlY2sKICAgICAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFJlbWFpbmluZyBUVEwgaW4gbWlsbGlzZWNvbmRzCiAgICAgICAgICovCiAgICAgICAgZ2V0VFRMOiBmdW5jdGlvbihrZXkpewogICAgICAgICAgICB2YXIgY3VydGltZSA9ICtuZXcgRGF0ZSgpLCB0dGw7CiAgICAgICAgICAgIF9jaGVja0tleShrZXkpOwogICAgICAgICAgICBpZihrZXkgaW4gX3N0b3JhZ2UgJiYgX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlRUTCAmJiBfc3RvcmFnZS5fX2pzdG9yYWdlX21ldGEuVFRMW2tleV0pewogICAgICAgICAgICAgICAgdHRsID0gX3N0b3JhZ2UuX19qc3RvcmFnZV9tZXRhLlRUTFtrZXldIC0gY3VydGltZTsKICAgICAgICAgICAgICAgIHJldHVybiB0dGwgfHwgMDsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBEZWxldGVzIGV2ZXJ5dGhpbmcgaW4gY2FjaGUuCiAgICAgICAgICoKICAgICAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBBbHdheXMgdHJ1ZQogICAgICAgICAqLwogICAgICAgIGZsdXNoOiBmdW5jdGlvbigpewogICAgICAgICAgICBfc3RvcmFnZSA9IHtfX2pzdG9yYWdlX21ldGE6e0NSQzMyOnt9fX07CiAgICAgICAgICAgIF9jcmVhdGVQb2x5ZmlsbFN0b3JhZ2UoImxvY2FsIiwgdHJ1ZSk7CiAgICAgICAgICAgIF9zYXZlKCk7CiAgICAgICAgICAgIF9wdWJsaXNoQ2hhbmdlKCk7CiAgICAgICAgICAgIF9maXJlT2JzZXJ2ZXJzKG51bGwsICJmbHVzaGVkIik7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYSByZWFkLW9ubHkgY29weSBvZiBfc3RvcmFnZQogICAgICAgICAqCiAgICAgICAgICogQHJldHVybiB7T2JqZWN0fSBSZWFkLW9ubHkgY29weSBvZiBfc3RvcmFnZQogICAgICAgICovCiAgICAgICAgc3RvcmFnZU9iajogZnVuY3Rpb24oKXsKICAgICAgICAgICAgZnVuY3Rpb24gRigpIHt9CiAgICAgICAgICAgIEYucHJvdG90eXBlID0gX3N0b3JhZ2U7CiAgICAgICAgICAgIHJldHVybiBuZXcgRigpOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIFJldHVybnMgYW4gaW5kZXggb2YgYWxsIHVzZWQga2V5cyBhcyBhbiBhcnJheQogICAgICAgICAqIFsna2V5MScsICdrZXkyJywuLidrZXlOJ10KICAgICAgICAgKgogICAgICAgICAqIEByZXR1cm4ge0FycmF5fSBVc2VkIGtleXMKICAgICAgICAqLwogICAgICAgIGluZGV4OiBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgaW5kZXggPSBbXSwgaTsKICAgICAgICAgICAgZm9yKGkgaW4gX3N0b3JhZ2UpewogICAgICAgICAgICAgICAgaWYoX3N0b3JhZ2UuaGFzT3duUHJvcGVydHkoaSkgJiYgaSAhPSAiX19qc3RvcmFnZV9tZXRhIil7CiAgICAgICAgICAgICAgICAgICAgaW5kZXgucHVzaChpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gaW5kZXg7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogSG93IG11Y2ggc3BhY2UgaW4gYnl0ZXMgZG9lcyB0aGUgc3RvcmFnZSB0YWtlPwogICAgICAgICAqCiAgICAgICAgICogQHJldHVybiB7TnVtYmVyfSBTdG9yYWdlIHNpemUgaW4gY2hhcnMgKG5vdCB0aGUgc2FtZSBhcyBpbiBieXRlcywKICAgICAgICAgKiAgICAgICAgICAgICAgICAgIHNpbmNlIHNvbWUgY2hhcnMgbWF5IHRha2Ugc2V2ZXJhbCBieXRlcykKICAgICAgICAgKi8KICAgICAgICBzdG9yYWdlU2l6ZTogZnVuY3Rpb24oKXsKICAgICAgICAgICAgcmV0dXJuIF9zdG9yYWdlX3NpemU7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogV2hpY2ggYmFja2VuZCBpcyBjdXJyZW50bHkgaW4gdXNlPwogICAgICAgICAqCiAgICAgICAgICogQHJldHVybiB7U3RyaW5nfSBCYWNrZW5kIG5hbWUKICAgICAgICAgKi8KICAgICAgICBjdXJyZW50QmFja2VuZDogZnVuY3Rpb24oKXsKICAgICAgICAgICAgcmV0dXJuIF9iYWNrZW5kOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIFRlc3QgaWYgc3RvcmFnZSBpcyBhdmFpbGFibGUKICAgICAgICAgKgogICAgICAgICAqIEByZXR1cm4ge0Jvb2xlYW59IFRydWUgaWYgc3RvcmFnZSBjYW4gYmUgdXNlZAogICAgICAgICAqLwogICAgICAgIHN0b3JhZ2VBdmFpbGFibGU6IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHJldHVybiAhIV9iYWNrZW5kOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIFJlZ2lzdGVyIGNoYW5nZSBsaXN0ZW5lcnMKICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBrZXkgS2V5IG5hbWUKICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBGdW5jdGlvbiB0byBydW4gd2hlbiB0aGUga2V5IGNoYW5nZXMKICAgICAgICAgKi8KICAgICAgICBsaXN0ZW5LZXlDaGFuZ2U6IGZ1bmN0aW9uKGtleSwgY2FsbGJhY2spewogICAgICAgICAgICBfY2hlY2tLZXkoa2V5KTsKICAgICAgICAgICAgaWYoIV9vYnNlcnZlcnNba2V5XSl7CiAgICAgICAgICAgICAgICBfb2JzZXJ2ZXJzW2tleV0gPSBbXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfb2JzZXJ2ZXJzW2tleV0ucHVzaChjYWxsYmFjayk7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogUmVtb3ZlIGNoYW5nZSBsaXN0ZW5lcnMKICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBrZXkgS2V5IG5hbWUgdG8gdW5yZWdpc3RlciBsaXN0ZW5lcnMgYWdhaW5zdAogICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFja10gSWYgc2V0LCB1bnJlZ2lzdGVyIHRoZSBjYWxsYmFjaywgaWYgbm90IC0gdW5yZWdpc3RlciBhbGwKICAgICAgICAgKi8KICAgICAgICBzdG9wTGlzdGVuaW5nOiBmdW5jdGlvbihrZXksIGNhbGxiYWNrKXsKICAgICAgICAgICAgX2NoZWNrS2V5KGtleSk7CgogICAgICAgICAgICBpZighX29ic2VydmVyc1trZXldKXsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoIWNhbGxiYWNrKXsKICAgICAgICAgICAgICAgIGRlbGV0ZSBfb2JzZXJ2ZXJzW2tleV07CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvcih2YXIgaSA9IF9vYnNlcnZlcnNba2V5XS5sZW5ndGggLSAxOyBpPj0wOyBpLS0pewogICAgICAgICAgICAgICAgaWYoX29ic2VydmVyc1trZXldW2ldID09IGNhbGxiYWNrKXsKICAgICAgICAgICAgICAgICAgICBfb2JzZXJ2ZXJzW2tleV0uc3BsaWNlKGksMSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBTdWJzY3JpYmUgdG8gYSBQdWJsaXNoL1N1YnNjcmliZSBldmVudCBzdHJlYW0KICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGFubmVsIENoYW5uZWwgbmFtZQogICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIEZ1bmN0aW9uIHRvIHJ1biB3aGVuIHRoZSBzb21ldGhpbmcgaXMgcHVibGlzaGVkIHRvIHRoZSBjaGFubmVsCiAgICAgICAgICovCiAgICAgICAgc3Vic2NyaWJlOiBmdW5jdGlvbihjaGFubmVsLCBjYWxsYmFjayl7CiAgICAgICAgICAgIGNoYW5uZWwgPSAoY2hhbm5lbCB8fCAiIikudG9TdHJpbmcoKTsKICAgICAgICAgICAgaWYoIWNoYW5uZWwpewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2hhbm5lbCBub3QgZGVmaW5lZCcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCFfcHVic3ViX29ic2VydmVyc1tjaGFubmVsXSl7CiAgICAgICAgICAgICAgICBfcHVic3ViX29ic2VydmVyc1tjaGFubmVsXSA9IFtdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9wdWJzdWJfb2JzZXJ2ZXJzW2NoYW5uZWxdLnB1c2goY2FsbGJhY2spOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIFB1Ymxpc2ggZGF0YSB0byBhbiBldmVudCBzdHJlYW0KICAgICAgICAgKgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjaGFubmVsIENoYW5uZWwgbmFtZQogICAgICAgICAqIEBwYXJhbSB7TWl4ZWR9IHBheWxvYWQgUGF5bG9hZCB0byBkZWxpdmVyCiAgICAgICAgICovCiAgICAgICAgcHVibGlzaDogZnVuY3Rpb24oY2hhbm5lbCwgcGF5bG9hZCl7CiAgICAgICAgICAgIGNoYW5uZWwgPSAoY2hhbm5lbCB8fCAiIikudG9TdHJpbmcoKTsKICAgICAgICAgICAgaWYoIWNoYW5uZWwpewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2hhbm5lbCBub3QgZGVmaW5lZCcpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfcHVibGlzaChjaGFubmVsLCBwYXlsb2FkKTsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBSZWxvYWRzIHRoZSBkYXRhIGZyb20gYnJvd3NlciBzdG9yYWdlCiAgICAgICAgICovCiAgICAgICAgcmVJbml0OiBmdW5jdGlvbigpewogICAgICAgICAgICBfcmVsb2FkRGF0YSgpOwogICAgICAgIH0KICAgIH07CgogICAgLy8gSW5pdGlhbGl6ZSBqU3RvcmFnZQogICAgX2luaXQoKTsKCn0pKCk7</File>
        <File Location="var/httpd/htdocs/js/Core.Agent.Admin.AdminSelectBox.js" Permission="666" Encode="Base64">Ly8gLS0KLy8gQ29yZS5BZ2VudC5BZG1pbi5BZG1pblNlbGVjdEJveC5qcyAtIHByb3ZpZGVzIHRoZSBzcGVjaWFsIG1vZHVsZSBmdW5jdGlvbnMgZm9yIHRoZSBBZG1pblNlbGVjdEJveAovLyBDb3B5cmlnaHQgKEMpIDIwMDEtMjAxMyBiaWVsaSwgaHR0cDovL2JpZWxpLm5ldC8KLy8gLS0KLy8gJElkOiBDb3JlLkFnZW50LkFkbWluLkFkbWluU2VsZWN0Qm94LmpzLHYgMS4wLjAuMCAyMDEyLzA5LzIwIDE2OjE1OjM0IGJpZWxpIEV4cCAkCi8vIC0tCi8vIFRoaXMgc29mdHdhcmUgY29tZXMgd2l0aCBBQlNPTFVURUxZIE5PIFdBUlJBTlRZLiBGb3IgZGV0YWlscywgc2VlCi8vIHRoZSBlbmNsb3NlZCBmaWxlIENPUFlJTkcgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24gKEFHUEwpLiBJZiB5b3UKLy8gZGlkIG5vdCByZWNlaXZlIHRoaXMgZmlsZSwgc2VlIGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy9hZ3BsLnR4dC4KLy8gLS0KCiJ1c2Ugc3RyaWN0IjsKCnZhciBDb3JlID0gQ29yZSB8fCB7fTsKQ29yZS5BZ2VudCA9IENvcmUuQWdlbnQgfHwge307CkNvcmUuQWdlbnQuQWRtaW4gPSBDb3JlLkFnZW50LkFkbWluIHx8IHt9OwoKLyoqCiAqIEBuYW1lc3BhY2UgICBBZG1pblNlbGVjdEJveAogKiBAZXhwb3J0cyAgICAgVGFyZ2V0TlMgYXMgQ29yZS5BZ2VudC5BZG1pbi5BZG1pblNlbGVjdEJveAogKiBAZGVzY3JpcHRpb24gCiAqICAgICAgVGhpcyBuYW1lc3BhY2UgY29udGFpbnMgdGhlIHNwZWNpYWwgbW9kdWxlIGZ1bmN0aW9ucyBmb3IgdGhlIEFkbWluU2VsZWN0Qm94IG1vZHVsZS4KICovCkNvcmUuQWdlbnQuQWRtaW4uQWRtaW5TZWxlY3RCb3ggPSAoZnVuY3Rpb24gKFRhcmdldE5TKSB7CgogICAgZnVuY3Rpb24gYWRkQmxvY2soKSB7CiAgICAgICAgJCgnZGl2LlNpZGViYXJDb2x1bW4nKS5hcHBlbmQoJzxkaXYgY2xhc3M9IldpZGdldFNpbXBsZSI+PGRpdiBjbGFzcz0iSGVhZGVyIj48aDI+U1FMIFF1ZXJpZXMgSGlzdG9yeTwvaDI+PC9kaXY+PGRpdiBjbGFzcz0iQ29udGVudCI+PHA+PHVsIGlkPSJzcWxfcXVlcmllcyI+PC91bD48L3A+PC9kaXY+PC9kaXY+Jyk7CiAgICB9OwoKICAgIGZ1bmN0aW9uIGxvYWRMaXN0KCkgewogICAgICAgIHZhciBzcWxfcXVlcmllcyA9ICQualN0b3JhZ2UuZ2V0KCdvdHJzX3NxbF9xdWVyaWVzX2hpc3RvcnknKTsgICAgCiAgICAgICAgICAgIGlmIChzcWxfcXVlcmllcykgewogICAgICAgICAgICAgICAgdmFyIGxhc3QgPSAiIjsKICAgICAgICAgICAgICAgIHZhciBpdGVtID0gMTsKCiAgICAgICAgICAgICAgICBzcWxfcXVlcmllcy5mb3JFYWNoKCBmdW5jdGlvbihrLCB2KSB7IAoKICAgICAgICAgICAgICAgIGlmICggbGFzdCAhPSBrLnF1ZXJ5ICkgewogICAgICAgICAgICAgICAgICAkKCd1bCNzcWxfcXVlcmllcycpLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICQoJzxsaT4nKQogICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KGsucXVlcnkuc2xpY2UoMCwgMzApICsgJyBbLi5dICcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RpdGxlJywgay5xdWVyeSkKICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCc8YnV0dG9uPicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignaWQnLCAnc3FoX2J0bl8nICsgaXRlbSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdzcWhfYnRuJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdzdHlsZScsICdoZWlnaHQ6IDIycHg7IHdpZHRoOiAyMnB4OyBmb250LXNpemU6IDE0cHg7JykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCduYW1lJywgJ3NxaF9idG5fJyArIGl0ZW0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignZGF0YS10aW1lc3RhbXAnLCBrLnRpbWVzdGFtcCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkYXRhLXF1ZXJ5Jywgay5xdWVyeSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KCLih5IiKQogICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCc8YnV0dG9uPicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignaWQnLCAnc3FoX2J0bl9kZWxldGVfJyArIGl0ZW0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnc3FoX2J0bicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignc3R5bGUnLCAnaGVpZ2h0OiAyMnB4OyB3aWR0aDogMjJweDsgZm9udC1zaXplOiAxNHB4OycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignbmFtZScsICdzcWhfYnRuX2RlbGV0ZV8nICsgaXRlbSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdkYXRhLXRpbWVzdGFtcCcsIGsudGltZXN0YW1wKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRleHQoIngiKQogICAgICAgICAgICAgICAgICApKTsKCiAgICAgICAgICAgICAgICAgIGxhc3QgPSBrLnF1ZXJ5OwogICAgICAgICAgICAgICAgICBpdGVtKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CgogICAgZnVuY3Rpb24gdXBkYXRlTGlzdChzcWxfcXVlcnkpIHsKICAgICAgICB2YXIgc3FsX3F1ZXJpZXMgPSAkLmpTdG9yYWdlLmdldCgnb3Ryc19zcWxfcXVlcmllc19oaXN0b3J5Jyk7ICAgIAogICAgICAgIHZhciBtaWxsaXNlY29uZHMgPSArbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgICAgdmFyIHJlc3VsdCA9IHRydWU7CgogICAgICAgIGlmIChzcWxfcXVlcmllcykgewogICAgICAgICAgICByZXN1bHQgPSBmYWxzZTsKCiAgICAgICAgICAgIHNxbF9xdWVyaWVzLmZvckVhY2goIGZ1bmN0aW9uKGssIHYpIHsgCiAgICAgICAgICAgICAgICBpZiAoIHNxbF9xdWVyeS50cmltKCkgPT0gay5xdWVyeS50cmltKCkgKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlOwogICAgICAgICAgICBzcWxfcXVlcmllcyA9IFtdOwogICAgICAgIH0KICAgICAgICAKICAgICAgICBpZiAoIHJlc3VsdCA9PSBmYWxzZSApIHsKICAgICAgICAgICAgc3FsX3F1ZXJpZXMucHVzaCh7ICd0aW1lc3RhbXAnIDogbWlsbGlzZWNvbmRzLCAncXVlcnknIDogc3FsX3F1ZXJ5LnRyaW0oKSB9KTsKCiAgICAgICAgICAgICQualN0b3JhZ2Uuc2V0KCdvdHJzX3NxbF9xdWVyaWVzX2hpc3RvcnknLCBzcWxfcXVlcmllcyk7CiAgICAgICAgfQogICAgfTsKCiAgICAvKioKICAgICAqIEBmdW5jdGlvbgogICAgICogQHJldHVybiBub3RoaW5nCiAgICAgKiAgICAgIFRoaXMgZnVuY3Rpb24gaW5pdGlhbGl6ZXMgdGhlIHNwZWNpYWwgbW9kdWxlIGZ1bmN0aW9ucwogICAgICovCiAgICBUYXJnZXROUy5Jbml0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICQoJyNSdW4nKS51bmJpbmQoJ2NsaWNrJykuY2xpY2soIGZ1bmN0aW9uICgpewogICAgICAgICAgICB2YXIgbWlsbGlzZWNvbmRzID0gK25ldyBEYXRlKCkuZ2V0VGltZSgpOwoKICAgICAgICAgICAgdmFyIHNxbF9xdWVyeSA9ICQoJyNTUUwnKS52YWwoKS50cmltKCkgKyAiIExJTUlUICIgKyAkKCcjTWF4JykudmFsKCkudHJpbSgpOwoKICAgICAgICAgICAgdXBkYXRlTGlzdChzcWxfcXVlcnkpOwoKICAgICAgICAgICAgbG9hZExpc3QoKTsKICAgICAgICB9KTsKICAgICAgICAgICAgCiAgICAgICAgJCgndWwjc3FsX3F1ZXJpZXMgbGkgYnV0dG9uW2lkXj0ic3FoX2J0bl8iXScpLnVuYmluZCgnY2xpY2snKS5jbGljayggZnVuY3Rpb24gKCl7CiAgICAgICAgICAgIHZhciBzcWxfcXVlcnkgPSAkKHRoaXMpLmRhdGEoInF1ZXJ5Iik7CgogICAgICAgICAgICAkKCcjU1FMJykudmFsKHNxbF9xdWVyeSk7CgogICAgICAgICAgICBsb2FkTGlzdCgpOwogICAgICAgIH0pOwoKICAgICAgICAkKCd1bCNzcWxfcXVlcmllcyBsaSBidXR0b25baWRePSJzcWhfYnRuX2RlbGV0ZV8iXScpLnVuYmluZCgnY2xpY2snKS5jbGljayggZnVuY3Rpb24gKCl7CiAgICAgICAgICAgICQodGhpcykucGFyZW50KCkucmVtb3ZlKCk7CiAgICAgICAgfSk7CgogICAgICAgIGFkZEJsb2NrKCk7CgogICAgICAgIGxvYWRMaXN0KCk7CiAgICB9OwoKICAgIHJldHVybiBUYXJnZXROUzsKfShDb3JlLkFnZW50LkFkbWluLkFkbWluU2VsZWN0Qm94IHx8IHt9KSk7CgpDb3JlLkFnZW50LkFkbWluLkFkbWluU2VsZWN0Qm94LkluaXQoKTsKCg==</File>
    </Filelist>
</otrs_package>